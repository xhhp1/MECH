<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>💼 الشؤون الإدارية 💼</title>
<style>
  body {
    margin:0;
    font-family: Tahoma, Arial, sans-serif;
    background:#222 url("https://raw.githubusercontent.com/xhhp1/mechanics/main/images/mechan.png") no-repeat center center fixed;
    background-size: cover;
    color:#e0ca51;
    text-align:center;
    padding:20px;
    box-sizing:border-box;
  }
  h1{margin:12px 0}
  .nav button{
    background:rgba(0,0,0,0.7);
    color:#e0ca51;
    border:2px solid #e0ca51;
    border-radius:10px;
    padding:10px 18px;
    margin:4px;
    font-size:16px;
    cursor:pointer;
    transition:all .3s;
  }
  .nav button:hover{background:#e0ca51;color:#000}
  .box{
    display:none;
    background:rgba(0,0,0,0.85);
    border-radius:12px;
    padding:15px;
    margin-top:15px;
    text-align:right;
  }
  label{display:block;margin:6px 0 3px}
  input,select{
    width:100%;
    padding:6px;
    border-radius:6px;
    border:1px solid #ccc;
    margin-bottom:8px;
    box-sizing:border-box;
  }
  textarea{
    width:100%;
    min-height:180px;
    margin-top:8px;
    border-radius:6px;
    border:1px solid #ccc;
    padding:6px;
    box-sizing:border-box;
  }
  .out{white-space:pre-wrap;background:#111;padding:10px;border-radius:8px;margin-top:10px}
  .btn2{
    background:#e0ca51;
    color:#000;
    border:none;
    border-radius:8px;
    padding:8px 16px;
    margin:4px 0;
    cursor:pointer;
  }
</style>
</head>
<body>
<h1>💼 قسم الشؤون الإدارية 💼</h1>
<div class="nav">
  <button onclick="show('vacBox')">إجازة داخلية</button>
  <button onclick="show('extBox')">إجازة خارجية</button>
  <button onclick="show('resBox')">استقالة</button>
  <button onclick="show('vioBox')">مخالفة</button>
  <button onclick="show('absBox')">فني لم يحضر</button>
</div>

<!-- إجازة داخلية -->
<div id="vacBox" class="box">
  <h2>إجازة داخلية</h2>
  <label>الكوبي ايدي:</label><input id="vac_copyId">
  <label>الرصيد (بالساعات):</label><input type="number" id="vac_balance">
  <label>تاريخ البداية:</label><input type="date" id="vac_startDate">
  <label>الساعة:</label>
  <select id="vac_startHour">
    ${[...Array(12)].map((_,i)=>`<option>${i+1}</option>`).join("")}
  </select>
  <select id="vac_startPeriod"><option>ص</option><option>م</option></select>
  <label>تاريخ النهاية:</label><input type="date" id="vac_endDate">
  <label>الساعة:</label>
  <select id="vac_endHour">
    ${[...Array(12)].map((_,i)=>`<option>${i+1}</option>`).join("")}
  </select>
  <select id="vac_endPeriod"><option>ص</option><option>م</option></select>
  <button class="btn2" onclick="vac_generate()">توليد</button>
  <button class="btn2" onclick="vac_copyResult()">نسخ</button>
  <div id="vac_output" class="out"></div>
</div>

<!-- إجازة خارجية -->
<div id="extBox" class="box">
  <h2>إجازة خارجية</h2>
  <label>الكوبي ايدي:</label><input id="ext_copyId">
  <label>مدة الاجازة (بالأيام):</label><input type="number" id="ext_days">
  <button class="btn2" onclick="ext_generate()">توليد</button>
  <button class="btn2" onclick="ext_copy()">نسخ</button>
  <div id="ext_output" class="out"></div>
</div>

<!-- استقالة -->
<div id="resBox" class="box">
  <h2>استقالة</h2>
  <label>الكوبي ايدي:</label><input id="res_copyId">
  <label>النوع:</label>
  <select id="res_type" onchange="res_toggleLevel()">
    <option value="متدرب">متدرب</option>
    <option value="اعلى">مستوى أعلى</option>
  </select>
  <div id="res_levelBox" style="display:none">
    <label>رقم المستوى:</label><input id="res_levelNumber">
  </div>
  <button class="btn2" onclick="res_generate()">توليد</button>
  <button class="btn2" onclick="res_copy()">نسخ</button>
  <div id="res_output" class="out"></div>
</div>

<!-- مخالفة -->
<div id="vioBox" class="box">
  <h2>مخالفة</h2>
  <label>الكوبي ايدي:</label><input id="vio_copyId">
  <label>درجة الانذار:</label>
  <select id="vio_warningLevel"><option>أول</option><option>ثاني</option><option>ثالث</option></select>
  <label>قيمة الغرامة:</label><input id="vio_fineAmount">
  <label>سبب المخالفة:</label><input id="vio_selected">
  <button class="btn2" onclick="vio_generate()">توليد</button>
  <button class="btn2" onclick="vio_copy()">نسخ</button>
  <div id="vio_output" class="out"></div>
</div>

<!-- فني لم يحضر -->
<div id="absBox" class="box">
  <h2>فني لم يحضر</h2>
  <label>الكوبي ايدي:</label><input id="abs_copyId">
  <label>السبب:</label><input id="abs_selected">
  <label>قيمة المخالفة:</label><input id="abs_penalty">
  <label>الانذار:</label><select id="abs_warning"><option>نعم</option><option>لا</option></select>
  <label>لم تتم مخالفته بسبب:</label><input id="abs_notPunished">
  <button class="btn2" onclick="abs_generate()">توليد</button>
  <button class="btn2" onclick="abs_copy()">نسخ</button>
  <div id="abs_output" class="out"></div>
</div>

<script>
function show(id){
  document.querySelectorAll('.box').forEach(b=>b.style.display='none');
  document.getElementById(id).style.display='block';
}

/* ---------- إجازة داخلية ---------- */
function vac_generate(){
  const copyId=document.getElementById('vac_copyId').value.trim();
  const balance=parseInt(document.getElementById('vac_balance').value,10);
  const startDateStr=document.getElementById('vac_startDate').value;
  const endDateStr=document.getElementById('vac_endDate').value;
  const startHourStr=document.getElementById('vac_startHour').value;
  const endHourStr=document.getElementById('vac_endHour').value;
  const startPeriod=document.getElementById('vac_startPeriod').value;
  const endPeriod=document.getElementById('vac_endPeriod').value;

  if(!copyId||!balance||!startDateStr||!endDateStr||!startHourStr||!endHourStr){
    alert("⚠️ يرجى إدخال جميع الحقول");return;
  }

  let startDate=new Date(startDateStr);
  let endDate=new Date(endDateStr);
  let startHour=parseInt(startHourStr,10);
  let endHour=parseInt(endHourStr,10);

  // تحويل 12 ساعة إلى 24
  if(startPeriod==="ص"&&startHour===12)startHour=0;
  if(startPeriod==="م"&&startHour<12)startHour+=12;
  if(endPeriod==="ص"&&endHour===12)endHour=0;
  if(endPeriod==="م"&&endHour<12)endHour+=12;

  startDate.setHours(startHour,0,0,0);
  endDate.setHours(endHour,0,0,0);
  if(endDate<=startDate){alert("⚠️ النهاية يجب أن تكون بعد البداية");return;}

  const duration=Math.round((endDate-startDate)/36e5);
  function formatDate(d){
    return `${d.getFullYear()}/${String(d.getMonth()+1).padStart(2,'0')}/${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:00`;
  }

  let headerText="الفني المحترم";
  const result=
`***\` إجازة داخلية \`*** 

***\`${headerText} :\`***  <@${copyId}>   

***\`المــــدة :\` ${duration} ساعة***  

***\`الرصيد المتبقي :\` ${balance - duration} ساعة***  

***من تاريخ ${formatDate(startDate)}***  
***الى تاريخ ${formatDate(endDate)}***  

***\`ملاحظة :\`***  
***تنتهي اجازتك بنفس التوقيت اللي بترجع فية .***  

***\`تنويهات هامة يجب قرائتها :\`***  

***01/ تبدأ الإجازة الخاصة بك في وقتها المحدد، ويُمنع تغيير الوظيفة قبل المدة المحددة لبدء الإجازة.***  

***02/ يجب العودة من الإجازة قبل انتهاء مدتها وتغيير الوظيفة إلى قطاع الميكانيك. من يخالف ذلك سيُعتبر تهرباً وظيفياً وستتم محاسبته من قِبل إدارة الكراج.***  

***03/ في حال عندك عذر وقدمته بفتح تكت اجازة سيتم فقط تصفير اجازاتك مهما كان السبب وعدم اعطائك تهرب وظيفي***  

***04/ في حال تم سجنك رقابيا سيتم تطبيق العقوبه عليك حسب [قوانين الاجازات](https://ptb.discord.com/channels/1071933157097615480/1071934713524133918/1416990256070135900) ***  

***كذلك في حال تعديت نص الاسبوع ( الثلاثاء ) او كان رصيدك اقل من نص اجماليك سيتم تصفيرك الاسبوع الحالي والقادم***  

<@&1149742928953086105>`;

  const out=document.getElementById('vac_output');
  out.innerText=result;out.style.display='block';
}
function vac_copyResult(){
  const out=document.getElementById('vac_output');
  if(!out||!out.innerText.trim()){alert("⚠️ لا يوجد نتيجة");return;}
  navigator.clipboard.writeText(out.innerText).then(()=>alert("✅ تم النسخ"));
}

/* ---------- إجازة خارجية ---------- */
function ext_generate(){
  const copyId=document.getElementById('ext_copyId').value.trim();
  const days=parseInt(document.getElementById('ext_days').value,10);
  if(!copyId||!days||days<=0){alert("⚠️ أدخل الكوبي ايدي والمدة");return;}
  let tzDate=new Date(new Date().toLocaleString("en-US",{timeZone:"Asia/Riyadh"}));
  let startDate=new Date(tzDate.getFullYear(),tzDate.getMonth(),tzDate.getDate());
  let endDate=new Date(startDate);endDate.setDate(endDate.getDate()+days);
  function fmt(d){return `${d.getFullYear()}/${String(d.getMonth()+1).padStart(2,'0')}/${String(d.getDate()).padStart(2,'0')}`;}
  const result=
`***\`  إجازة خارجية  \`***  

***\`الفني المحترم :\`***    <@${copyId}>         

***\`المــــدة :\` ${days} يوم***
 
***من تاريخ ${fmt(startDate)}***
***الى تاريخ ${fmt(endDate)}***

***\`ملاحظة :\`***
***تنتهي اجازتك الخارجية في نفس يوم انتهاء الاجازة.***

***\`تنويهات هامة يجب قرائتها :\`***
***01/ في حال بدت الاجازة يمنع منعا باتا دخولك للمقاطعة. من يخالف ذلك سيُعتبر تهرباً وظيفياً وستتم محاسبته من قِبل إدارة الكراج.***
***02/ في حال انتهاء الاجازة او اردت قطعها يجب فتح تكت اجازة وطلب قطعها او انهائها ويمنع المباشرة حتى ازالة رول اجازة وظيفية***
 
<@&1149742928953086105>`;
  const out=document.getElementById('ext_output');
  out.innerText=result;out.style.display='block';
}
function ext_copy(){
  const out=document.getElementById('ext_output');
  if(!out||!out.innerText.trim()){alert("⚠️ لا يوجد نتيجة");return;}
  navigator.clipboard.writeText(out.innerText).then(()=>alert("✅ تم النسخ"));
}

/* ---------- استقالة ---------- */
function res_toggleLevel(){
  document.getElementById('res_levelBox').style.display=(document.getElementById('res_type').value==='اعلى')?'block':'none';
}
function res_generate(){
  const type=document.getElementById('res_type').value;
  const copyId=document.getElementById('res_copyId').value.trim();
  const levelNumber=document.getElementById('res_levelNumber').value.trim();
  if(!copyId){alert("⚠️ أدخل الكوبي ايدي");return;}
  let result="";
  if(type==="متدرب"){
    result=`*** ▬▬▬ ﷽ ▬▬
\`\`\`diff
-الموضوع : قرار انهاء خدمات
\`\`\`
\`\`\`cs
# بعد الاطلاع على نظام التوظيف والترقيات وانهاء الخدمة قررنا مايلي
اولاً: تنهى خدمات الفني ادناه اعتبارا من تاريخه
ثانياً: منع توظيف 14 يوم
ثالثاً:غرامه مالية قدرها 1,000,000
\`\`\`
<@${copyId}>
\`\`\`بسبب : استقالة مستوى متدرب \`\`\`
***`;
  } else {
    if(!levelNumber){alert("⚠️ أدخل رقم المستوى");return;}
    result=`*** ▬▬▬ ﷽ ▬▬
\`\`\`diff
-الموضوع : قرار انهاء خدمات
\`\`\`
<@${copyId}>
\`\`\`بسبب : استقالة برتبة مستوى (${levelNumber}) بناءاً على طلبه\`\`\`
***`;
  }
  const out=document.getElementById('res_output');
  out.innerText=result;out.style.display='block';
}
function res_copy(){
  const out=document.getElementById('res_output');
  if(!out||!out.innerText.trim()){alert("⚠️ لا يوجد نتيجة");return;}
  navigator.clipboard.writeText(out.innerText).then(()=>alert("✅ تم النسخ"));
}

/* ---------- مخالفة ---------- */
function vio_generate(){
  const copyId=document.getElementById('vio_copyId').value.trim();
  const warning=document.getElementById('vio_warningLevel').value;
  const fine=document.getElementById('vio_fineAmount').value.trim();
  const reason=document.getElementById('vio_selected').value.trim();
  if(!copyId||!fine||!reason){alert("⚠️ أدخل كل البيانات");return;}
  const result=
`*** ▬▬▬ ﷽ ▬▬
\`\`\`diff
-الموضوع : انذار وظيفي وغرامة
\`\`\`
<@${copyId}>
انذار: ${warning}
غرامة: ${fine}
بسبب: ${reason}
***`;
  const out=document.getElementById('vio_output');
  out.innerText=result;out.style.display='block';
}
function vio_copy(){
  const out=document.getElementById('vio_output');
  if(!out||!out.innerText.trim()){alert("⚠️ لا يوجد نتيجة");return;}
  navigator.clipboard.writeText(out.innerText).then(()=>alert("✅ تم النسخ"));
}

/* ---------- ABSENT (فني لم يحضر) module using custom dropdown ---------- */
function abs_generate(){
  const copyId = document.getElementById('abs_copyId').value.trim();
  const reason = document.getElementById('abs_selected').value || '';
  const penalty = document.getElementById('abs_penalty').value.trim();
  const warning = document.getElementById('abs_warning').value;
  const notPunished = document.getElementById('abs_notPunished').value.trim();

  if(!copyId || !reason || !penalty || !warning){
    alert("يرجى ملء جميع الحقول المطلوبة"); return;
  }

  const resultText =
`***\`  نموذج إستدعاء للفني الذي لم يحضر  \`***

***\`اسم الفني\`***  <@${copyId}>

***\`سبب الاستدعاء \`***   ${reason}

***\`قيمة المخالفة\`*** ${Number(penalty).toLocaleString()}

***\` الانذار المستحق ؟ : \`*** ${warning}

***\`لم تتم مخالفته بسبب\`*** ${notPunished}

***الي يجيه الفني يعلمه سبب المخالفة  وينزله المخالفة في روم
https://ptb.discord.com/channels/1071933157097615480/1071934723858894868 ***  

***نسخه الى***
 <@&1071933357136556183>  - <@&1142626431101325403>`;

  const out = document.getElementById('abs_output');
  out.innerText = resultText;
  out.style.display = 'block';
}
function abs_copy(){
  const out = document.getElementById('abs_output');
  if(!out || !out.innerText.trim()){ alert("⚠️ لا يوجد نتيجة لنسخها"); return; }
  navigator.clipboard.writeText(out.innerText).then(()=>alert("✅ تم النسخ"));
}

/* ---------- EXTERNAL VACATION (إجازة خارجية) new module - exact template ---------- */
function ext_generate(){
  const copyId = document.getElementById('ext_copyId').value.trim();
  const days = parseInt(document.getElementById('ext_days').value,10);
  if(!copyId || !days || days <= 0){ alert("⚠️ يرجى إدخال الكوبي ايدي والمدة بالأيام صحيحة"); return; }

  // start = today (Riyadh timezone attempt), end = today + days
  let tzDate = new Date(new Date().toLocaleString("en-US", { timeZone: "Asia/Riyadh" }));
  let startDate = new Date(tzDate.getFullYear(), tzDate.getMonth(), tzDate.getDate());
  let endDate = new Date(startDate);
  endDate.setDate(endDate.getDate() + days);

  function fmtYMD(d){
    let y=d.getFullYear();
    let m=String(d.getMonth()+1).padStart(2,'0');
    let day=String(d.getDate()).padStart(2,'0');
    return `${y}/${m}/${day}`;
  }

  const result =
`***\`  إجازة خارجية  \`***  

***\`الفني المحترم :\`***    <@${copyId}>         

***\`المــــدة :\` ${days} يوم***
 
***من تاريخ ${fmtYMD(startDate)}***
*** الى تاريخ ${fmtYMD(endDate)}***

***\`ملاحظة :\`***

***تنتهي اجازتك الخارجية في نفس يوم انتهاء الاجازة.***

***\`تنويهات هامة يجب قرائتها :\`***

***01/ في حال بدت الاجازة يمنع منعا باتا دخولك للمقاطعة. من يخالف ذلك سيُعتبر تهرباً وظيفياً وستتم محاسبته من قِبل إدارة الكراج.***

***02/ في حال انتهاء الاجازة او اردت قطعها يجب فتح تكت اجازة وطلب قطعها او انهائها ويمنع المباشرة حتى ازالة رول اجازة وظيفية***
 
<@&1149742928953086105>`;

  const out = document.getElementById('ext_output');
  out.innerText = result;
  out.style.display = 'block';
}
function ext_copy(){
  const out = document.getElementById('ext_output');
  if(!out || !out.innerText.trim()){ alert("⚠️ لا يوجد نتيجة لنسخها"); return; }
  navigator.clipboard.writeText(out.innerText).then(()=>alert("✅ تم النسخ"));
}

/* ---------- utilities: show default tab ---------- */
show('vacBox');
</script>

</body>
</html>
